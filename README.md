# Python API Server —Å –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –≤–∏–¥–µ–æ

–£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π Python API —Å–µ—Ä–≤–µ—Ä –Ω–∞ FastAPI –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –∏ –≤–∏–¥–µ–æ —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –æ—á–∏—Å—Ç–∫–æ–π —Ñ–∞–π–ª–æ–≤.

## üöÄ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- **–û–±—Ä–∞–±–æ—Ç–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –∏ –≤–∏–¥–µ–æ** —Å –∫–æ—Ä—Ä–µ–∫—Ü–∏–µ–π —Ü–≤–µ—Ç–æ–≤ –¥–ª—è –ø–æ–¥–≤–æ–¥–Ω–æ–π —Å—ä–µ–º–∫–∏
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞ —Ñ–∞–π–ª–æ–≤** –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –Ω–æ–≤—ã—Ö
- **–£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏** –¥–ª—è Debian/Ubuntu
- **–ú—è–≥–∫–∞—è –æ—á–∏—Å—Ç–∫–∞ –¥–∏—Å–∫–∞** –µ–∂–µ–Ω–µ–¥–µ–ª—å–Ω–æ
- **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ä–µ—Å—É—Ä—Å–æ–≤** (–¥–∏—Å–∫, –ø–∞–º—è—Ç—å, API)
- **Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è** —Å –ø–æ–ª–Ω—ã–º –Ω–∞–±–æ—Ä–æ–º —Å–µ—Ä–≤–∏—Å–æ–≤

## üìã –°–∏—Å—Ç–µ–º–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

- **–û–°**: Debian 10+ –∏–ª–∏ Ubuntu 18.04+
- **RAM**: –º–∏–Ω–∏–º—É–º 2GB (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è 4GB+)
- **–î–∏—Å–∫**: –º–∏–Ω–∏–º—É–º 10GB —Å–≤–æ–±–æ–¥–Ω–æ–≥–æ –º–µ—Å—Ç–∞
- **CPU**: 2+ —è–¥—Ä–∞
- **–°–µ—Ç—å**: –¥–æ—Å—Ç—É–ø –∫ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç—É –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

## üõ† –ë—ã—Å—Ç—Ä–æ–µ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

1. **–°–æ–∑–¥–∞–π—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –∏–∑ —à–∞–±–ª–æ–Ω–∞:**
```bash
cp server_config.example.json server_config.json
```

2. **–û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ –¥–∞–Ω–Ω—ã–µ —Å–µ—Ä–≤–µ—Ä–∞:**
```bash
nano server_config.json
```

**–û—Å–Ω–æ–≤–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è:**
- `server.host` - IP –∞–¥—Ä–µ—Å –∏–ª–∏ –¥–æ–º–µ–Ω –≤–∞—à–µ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞
- `server.username` - –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–ª—è SSH (–æ–±—ã—á–Ω–æ `root`)
- `server.auth_method` - –º–µ—Ç–æ–¥ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏: `"password"` –∏–ª–∏ `"key"`
- `server.password` - –ø–∞—Ä–æ–ª—å –¥–ª—è SSH –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `auth_method: "password"`)
- `server.ssh_key_path` - –ø—É—Ç—å –∫ –ø—Ä–∏–≤–∞—Ç–Ω–æ–º—É SSH –∫–ª—é—á—É (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `auth_method: "key"`)

**–ü—Ä–∏–º–µ—Ä—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏:**

**–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –ø–æ –ø–∞—Ä–æ–ª—é:**
```json
{
  "server": {
    "host": "192.168.1.100",
    "username": "root",
    "auth_method": "password",
    "password": "your-password"
  }
}
```

**–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –ø–æ SSH –∫–ª—é—á—É:**
```json
{
  "server": {
    "host": "192.168.1.100",
    "username": "root",
    "auth_method": "key",
    "ssh_key_path": "/home/user/.ssh/id_rsa"
  }
}
```

> ‚ö†Ô∏è **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**: –§–∞–π–ª `server_config.json` —Å–æ–¥–µ—Ä–∂–∏—Ç –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏ –∏—Å–∫–ª—é—á–µ–Ω –∏–∑ git.

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ

**–£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π —Å–∫—Ä–∏–ø—Ç (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è):**
```bash
python3 scripts/deploy_universal.py
```

**–†—É—á–Ω–æ–µ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ:**
```bash
# –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Å–∫—Ä–∏–ø—Ç –Ω–∞ —Å–µ—Ä–≤–µ—Ä
scp scripts/deploy_universal.sh root@your-server:/tmp/
ssh root@your-server "chmod +x /tmp/deploy_universal.sh && /tmp/deploy_universal.sh"

# –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Ñ–∞–π–ª—ã –ø—Ä–æ–µ–∫—Ç–∞
scp -r . root@your-server:/opt/dive-color-corrector/

# –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ä–≤–∏—Å
ssh root@your-server "systemctl start dive-color-corrector.service"
```

### –õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞

```bash
pip install -r src/requirements.txt
python app.py
```

–°–µ—Ä–≤–µ—Ä –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ –∞–¥—Ä–µ—Å—É: http://localhost

## üìö API Endpoints

### –û—Å–Ω–æ–≤–Ω—ã–µ
- `GET /health` - –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏
- `GET /docs` - –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è API

### –ú–æ–±–∏–ª—å–Ω—ã–π API
- `GET /api/mobile/status` - –°—Ç–∞—Ç—É—Å API
- `GET /api/mobile/health` - –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è
- `POST /api/mobile/process/image` - –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
- `POST /api/mobile/process/video` - –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤–∏–¥–µ–æ
- `GET /api/mobile/files` - –°–ø–∏—Å–æ–∫ —Ñ–∞–π–ª–æ–≤
- `GET /api/download/{filename}` - –°–∫–∞—á–∏–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–∞

### –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã

**–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è:**
- JPG, JPEG, PNG, BMP

**–í–∏–¥–µ–æ:**
- MP4, AVI, MOV, MKV

**–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:**
- –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞: 500MB

## üîß –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–æ–º

### –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã
```bash
# –°—Ç–∞—Ç—É—Å —Å–µ—Ä–≤–∏—Å–∞
sudo systemctl status dive-color-corrector.service

# –ó–∞–ø—É—Å–∫/–æ—Å—Ç–∞–Ω–æ–≤–∫–∞/–ø–µ—Ä–µ–∑–∞–ø—É—Å–∫
sudo systemctl start dive-color-corrector.service
sudo systemctl stop dive-color-corrector.service
sudo systemctl restart dive-color-corrector.service
```

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
```bash
# –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ API
/opt/python-api-server/monitor.sh

# –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –¥–∏—Å–∫–∞
/opt/check_disk.sh

# –û—á–∏—Å—Ç–∫–∞ –¥–∏—Å–∫–∞
/opt/disk_cleanup.sh
```

## üí° –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
```bash
curl -X POST "http://your-server/api/mobile/process/image" \
  -H "Content-Type: multipart/form-data" \
  -F "file=@your-image.jpg"
```

### –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤–∏–¥–µ–æ
```bash
curl -X POST "http://your-server/api/mobile/process/video" \
  -H "Content-Type: multipart/form-data" \
  -F "file=@your-video.mp4"
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞
```bash
curl http://your-server/api/mobile/status
```

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞ —Ñ–∞–π–ª–æ–≤** –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –Ω–æ–≤—ã—Ö
- **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è**: –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞ 500MB
- **–£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ—Å—Ç—å**: —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ Debian –∏ Ubuntu
- **–ú—è–≥–∫–∞—è –æ—á–∏—Å—Ç–∫–∞ –¥–∏—Å–∫–∞** –µ–∂–µ–Ω–µ–¥–µ–ª—å–Ω–æ –≤ –≤–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ –≤ 3:00

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

- **Health check:** `curl http://your-server/health`
- **–õ–æ–≥–∏:** `docker-compose logs -f api`
- **–°—Ç–∞—Ç—É—Å API:** `curl http://your-server/api/mobile/status`
- **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–∏—Å—Ç–µ–º—ã:** `/opt/dive-color-corrector/monitor.sh`
- **–ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∏—Å–∫–∞:** `/opt/check_disk.sh`

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- **API –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:** http://your-server/docs
- **Swagger UI:** http://your-server/docs

## üìù –õ–∏—Ü–µ–Ω–∑–∏—è

MIT License
